package xyz.vsngamer.elevator.tileentity;

import java.util.List;

import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.tileentity.TileEntity;
import net.minecraft.util.ITickable;
import net.minecraft.util.math.AxisAlignedBB;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.text.TextComponentString;
import xyz.vsngamer.elevator.init.ModBlocks;

public class TileEntityElevator extends TileEntity implements ITickable {

	@Override
	public void update() {
		checkPlayer();
	}

	private void checkPlayer() {
		BlockPos pos1 = this.pos;
		AxisAlignedBB aabb = new AxisAlignedBB(pos1, pos1.add(1, 2, 1));
		List<EntityPlayer> list = this.worldObj.getEntitiesWithinAABB(EntityPlayer.class, aabb);

		if (list.size() > 0) {
			EntityPlayer player1 = list.get(0);

			if (player1.motionY > 0 && !(player1.isSneaking()) && !(player1.worldObj.isRemote)) {

				player1.addChatMessage(new TextComponentString("elevator"));

				while (pos1.up().getY() <= 255) {

					if (player1.worldObj.getBlockState(pos1).getBlock().equals(ModBlocks.elevator)) {

						player1.setPositionAndUpdate(pos1.getX() + 0.5, pos1.getY() + 1, pos1.getZ() + 0.5);
						player1.motionY = 0;
						player1.addChatMessage(new TextComponentString("elevator up"));
						break;

					}

					pos1 = pos1.add(0, 1, 0);

				}
			}
		}
	}
}
