package xyz.vsngamer.elevator.init;

import net.minecraft.entity.Entity;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.text.TextComponentString;
import net.minecraftforge.event.entity.living.LivingEvent.LivingJumpEvent;
import net.minecraftforge.event.entity.living.LivingEvent.LivingUpdateEvent;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class ModEvents {

	@SubscribeEvent
	public void onJump(LivingJumpEvent event) {

		Entity entity = event.getEntity();
		BlockPos pos1 = new BlockPos(entity);

		if (entity instanceof EntityPlayer
				&& entity.getEntityWorld().getBlockState(pos1.down()).getBlock().equals(ModBlocks.elevator)
				&& entity.getEntityWorld().isRemote && !entity.isSneaking()) {

			entity.addChatMessage(new TextComponentString("elevator"));

			while (pos1.getY() <= 255) {

				if (entity.getEntityWorld().getBlockState(pos1).getBlock().equals(ModBlocks.elevator)) {

					entity.setPositionAndUpdate(pos1.getX() + 0.5, pos1.getY() + 1, pos1.getZ() + 0.5);
					entity.motionY = 0;
					entity.addChatMessage(new TextComponentString("elevator up"));
					break;

				}

				pos1 = pos1.add(0, 1, 0);

			}
		}
	}

	@SubscribeEvent
	public void onSneak(LivingUpdateEvent event) {
		Entity entity = event.getEntity();
		BlockPos pos2 = new BlockPos(entity);

		if (entity instanceof EntityPlayer
				&& entity.getEntityWorld().getBlockState(pos2).getBlock().equals(ModBlocks.elevator)
				&& entity.getEntityWorld().isRemote && entity.isSneaking()) {
			
			while (pos2.getY() >= 0) {
				if (entity.getEntityWorld().getBlockState(pos2).getBlock().equals(ModBlocks.elevator)) {
					entity.setPositionAndUpdate(pos2.getX() + 0.5, pos2.getY() + 1, pos2.getZ() + 0.5);
					entity.addChatMessage(new TextComponentString("elevator up"));
					entity.setSneaking(false);
					break;
				}

				pos2 = pos2.add(0, -1, 0);

			}
		}

	}
}
